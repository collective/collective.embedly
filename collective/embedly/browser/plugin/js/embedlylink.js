function displayTab(e,t){var n,r,o,i,l,a;if(o=document.getElementById(e),n=document.getElementById(t),r=n?n.parentNode:null,i=o?o.parentNode:null,o&&i){for(l=i.childNodes,a=0;a<l.length;a++)"LI"==l[a].nodeName&&(l[a].getElementsByTagName("a")[0].className="",l[a].tabIndex=-1);o.getElementsByTagName("a")[0].className="selected",o.tabIndex=0}if(n&&r){for(l=r.childNodes,a=0;a<l.length;a++)"DIV"==l[a].nodeName&&(l[a].className="panel");n.className="current",toggleYoutubeFields(n)}}function toggleYoutubeFields(e){function t(e,t){e.className+=" "+t}function n(e,t){for(var n=e.className;-1!=n.indexOf(t);)n=n.replace(t,""),n=n.trim();e.className=n}if("advanced_panel"==e.id){var r=document.getElementById("externalurl").value,o=!1;(r.contains("://youtu")||r.contains("://www.youtu"))&&(o=!0);var l=e.getElementsByTagName("form")[0].getElementsByTagName("div");for(i=0;i<l.length;i++){var a=l[i];a.className.contains("youtube")&&(o?n(a,"hidden"):t(a,"hidden"))}}}function preinit(){var e=tinyMCEPopup.getParam("external_link_list_url");e&&document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(e)+'"></script>')}function initData(e){var t=e.split("?");if(2===t.length){var n=t[1].split("&"),r={},o=[],i=[];for(var l in n){var a=n[l].split("=");r[a[0]]=a[1]}for(l in value_getter)value_getter[l]in r&&(document.getElementById(value_getter[l]).value=r[value_getter[l]],o.push(value_getter[l]));for(l in checked_getter)checked_getter[l]in r&&(document.getElementById(checked_getter[l]).checked=!0,o.push(checked_getter[l]));for(l in unchecked_getter)if(unchecked_getter[l]in r){var u=r[unchecked_getter[l]];document.getElementById(unchecked_getter[l]).checked=u,o.push(unchecked_getter[l])}for(l in r)-1===o.indexOf(l)&&i.push(l+"="+r[l]);t[1]=i.join("&"),e=t.join("?")}return e}function init(){tinyMCEPopup.resizeToInnerSize();var formGeneralObj=document.forms[0],formAdvancedObj=document.forms[1],formButtonsObj=document.forms[2],inst=tinyMCEPopup.editor,elm=inst.selection.getNode(),action="insert",html,href;labels=eval(inst.getParam("labels")),elm=inst.dom.getParent(elm,"A"),null!==elm&&"A"==elm.nodeName&&(action="update"),tinyMCEPopup.editor.settings.rooted&&(document.getElementById("home").style.display="none"),"update"==action?(href=inst.dom.getAttrib(elm,"href"),href=tinymce.trim(href),setFormValue("href",href,0),"undefined"!=typeof elm.title&&""!==elm.title&&setFormValue("title",inst.dom.getAttrib(elm,"title"),2),href=initData(href),setFormValue("externalurl",href,0)):(href=inst.selection.getContent(),href=tinymce.trim(href),0===href.indexOf("http")&&setFormValue("externalurl",href,0))}function getParentUrl(e){var t=e.split("/");return t.pop(),t.join("/")}function getAbsoluteUrl(e,t){if(-1!=t.indexOf("http://")||-1!=t.indexOf("https://")||-1!=t.indexOf("ftp://"))return t;var n=e.split("/"),r=t.split("/");for(n.pop();0!==r.length;){var o=r.shift();"."==o||(".."==o?n.pop():n.push(o))}return n.join("/")}function setFormValue(e,t,n){document.forms[n].elements[e].value=t}function setAttrib(e,t,n,r){var o=document.forms[r],i=o.elements[t.toLowerCase()],l=tinyMCEPopup.editor.dom;("undefined"==typeof n||null===n)&&(n="",i&&(n=i.value)),l.setAttrib(e,t,n)}function previewExternalLink(){var url=document.getElementById("externalurl").value;elink="http://api.embed.ly/1/oembed?format=json",params={},params.url=escape(url);var api_key=document.getElementById("apikey").value;params.key=api_key;for(var i in params)params[i]&&(elink+="&"+i+"="+params[i]);var request=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),preview=document.getElementById("previewexternal");request.open("GET",elink,!0),request.onreadystatechange=function(){if(request.readyState==request.DONE){if(200==request.status){var resp=eval("("+request.responseText+")");"error"==resp.type?preview.innerHTML="<p class='error'>We couldn't process this URL. Try again, or email support@embed.ly.</p>":("photo"===resp.type?code='<a href="'+url+'" target="_blank"><img style="width:100%" src="'+resp.url+'" title="'+resp.title||document.title+'" /></a>':"video"===resp.type?code=resp.html:"rich"===resp.type?code=resp.html:(thumb=resp.thumbnail_url?'<img src="'+resp.thumbnail_url+'" class="thumb embedly-thumbnail-small" />':"",description=resp.description,code=thumb+"<a class='embedly-title' href='"+url+"'>"+title+"</a>",code+=description),pr='<div class="embedly">'+code+"</div>",preview.innerHTML=pr)}else preview.innerHTML="<p class='error'>We couldn't process this URL. Try again, or email support@embed.ly.</p>";request=null}},request.send()}function getInputValue(e,t){return document.forms[t].elements[e].value}function buildHref(){{var e,t,n="",r=[];tinyMCEPopup.editor}n=document.getElementById("externalurl").value;for(e in value_getter)t=document.getElementById(value_getter[e]).value,""!==t&&(r[value_getter[e]]=t);for(e in checked_getter)t=document.getElementById(checked_getter[e]).checked,t&&(r[checked_getter[e]]="true");for(e in unchecked_getter)t=document.getElementById(unchecked_getter[e]).checked,t&&(r[unchecked_getter[e]]="false");for(e in r)n+=-1===n.indexOf("?")?"?":"&",n+=e+"="+r[e];document.forms[0].href.value=n}function insertAction(){var e,t,n,r=tinyMCEPopup.editor;if(buildHref(),e=r.selection.getNode(),e=r.dom.getParent(e,"A"),!document.forms[0].href.value)return tinyMCEPopup.execCommand("mceBeginUndoLevel"),n=r.selection.getBookmark(),r.dom.remove(e,1),r.selection.moveToBookmark(n),tinyMCEPopup.execCommand("mceEndUndoLevel"),void tinyMCEPopup.close();if(tinyMCEPopup.execCommand("mceBeginUndoLevel"),null===e)for(r.getDoc().execCommand("unlink",!1,null),tinyMCEPopup.execCommand("CreateLink",!1,"#mce_temp_url#",{skip_undo:1}),t=tinymce.grep(r.dom.select("a"),function(e){return"#mce_temp_url#"==r.dom.getAttrib(e,"href")}),n=0;n<t.length;n++)setAllAttribs(e=t[n]);else setAllAttribs(e);!e||1==e.childNodes.length&&"IMG"==e.firstChild.nodeName||(r.focus(),r.selection.select(e),r.selection.collapse(0),tinyMCEPopup.storeSelection()),tinyMCEPopup.execCommand("mceEndUndoLevel"),tinyMCEPopup.close()}function setAllAttribs(e){var t=document.forms[0],n=document.forms[1],r=(document.forms[2],t.href.value);setAttrib(e,"href",r,0),setAttrib(e,"title",n.title.value,2);var o=tinyMCEPopup.editor.dom;o.addClass(e,"embedlylink"),tinyMCE.isMSIE5&&(e.outerHTML=e.outerHTML)}function getSelectValue(e,t){var n=e.elements[t];return n&&null!==n.options&&-1!=n.selectedIndex?n.options[n.selectedIndex].value:""}var templates={"window.open":"window.open('${url}','${target}','${options}')"},current_path,current_link="",current_url="",current_pageanchor="",labels="",value_getter=["maxwidth","maxheight","width","callback","wmode","words","chars"],checked_getter=["allowscripts","nostyle","autoplay","videosrc"],unchecked_getter=["youtube_rel"];preinit(),tinyMCEPopup.onInit.add(init);