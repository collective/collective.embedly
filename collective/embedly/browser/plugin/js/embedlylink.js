function displayTab(e,t){var n,r,i,s,o,u;i=document.getElementById(e);n=document.getElementById(t);r=n?n.parentNode:null;s=i?i.parentNode:null;if(i&&s){o=s.childNodes;for(u=0;u<o.length;u++){if(o[u].nodeName=="LI"){o[u].getElementsByTagName("a")[0].className="";o[u].tabIndex=-1}}i.getElementsByTagName("a")[0].className="selected";i.tabIndex=0}if(n&&r){o=r.childNodes;for(u=0;u<o.length;u++){if(o[u].nodeName=="DIV"){o[u].className="panel"}}n.className="current"}}function preinit(){var e=tinyMCEPopup.getParam("external_link_list_url");if(e)document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(e)+'"></script>')}function initData(e){var t=e.split("?");if(t.length===2){var n=t[1].split("&"),r={},i=[],s=[];for(var o in n){var u=n[o].split("=");r[u[0]]=u[1]}for(o in value_getter){if(value_getter[o]in r){document.getElementById(value_getter[o]).value=r[value_getter[o]];i.push(value_getter[o])}}for(o in checked_getter){if(checked_getter[o]in r){document.getElementById(checked_getter[o]).checked=true;i.push(checked_getter[o])}}for(o in unchecked_getter){if(unchecked_getter[o]in r){var a=r[unchecked_getter[o]];document.getElementById(unchecked_getter[o]).checked=a;i.push(unchecked_getter[o])}}for(o in r){if(i.indexOf(o)===-1){s.push(o+"="+r[o])}}t[1]=s.join("&");e=t.join("?")}return e}function init(){tinyMCEPopup.resizeToInnerSize();var formGeneralObj=document.forms[0];var formAdvancedObj=document.forms[1];var formButtonsObj=document.forms[2];var inst=tinyMCEPopup.editor;var elm=inst.selection.getNode();var action="insert";var html;var href;labels=eval(inst.getParam("labels"));elm=inst.dom.getParent(elm,"A");if(elm!==null&&elm.nodeName=="A")action="update";formButtonsObj.insert.value="Insert";if(tinyMCEPopup.editor.settings.rooted){document.getElementById("home").style.display="none"}if(action=="update"){href=inst.dom.getAttrib(elm,"href");href=tinymce.trim(href);setFormValue("href",href,0);if(typeof elm.title!="undefined"&&elm.title!==""){setFormValue("title",inst.dom.getAttrib(elm,"title"),2)}href=initData(href);setFormValue("externalurl",href,0)}else{href=inst.selection.getContent();href=tinymce.trim(href);if(href.indexOf("http")===0)setFormValue("externalurl",href,0)}}function getParentUrl(e){var t=e.split("/");t.pop();return t.join("/")}function getAbsoluteUrl(e,t){if(t.indexOf("http://")!=-1||t.indexOf("https://")!=-1||t.indexOf("ftp://")!=-1){return t}var n=e.split("/");var r=t.split("/");n.pop();while(r.length!==0){var i=r.shift();if(i=="."){}else if(i==".."){n.pop()}else{n.push(i)}}return n.join("/")}function setFormValue(e,t,n){document.forms[n].elements[e].value=t}function setAttrib(e,t,n,r){var i=document.forms[r];var s=i.elements[t.toLowerCase()];var o=tinyMCEPopup.editor.dom;if(typeof n=="undefined"||n===null){n="";if(s)n=s.value}o.setAttrib(e,t,n)}function previewExternalLink(){var url=document.getElementById("externalurl").value;elink="http://api.embed.ly/1/oembed?format=json";params={};params.url=escape(url);for(var i in params){if(params[i])elink+="&"+i+"="+params[i]}var request=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");var preview=document.getElementById("previewexternal");request.open("GET",elink,true);request.onreadystatechange=function(){if(request.readyState==request.DONE){if(request.status==200){var resp=eval("("+request.responseText+")");if(resp.type=="error"){preview.innerHTML="<p class='error'>We couldn't process this URL. Try again, or email support@embed.ly.</p>"}else{if(resp.type==="photo"){code='<a href="'+url+'" target="_blank"><img style="width:100%" src="'+resp.url+'" title="'+resp.title||document.title+'" /></a>'}else if(resp.type==="video"){code=resp.html}else if(resp.type==="rich"){code=resp.html}else{thumb=resp.thumbnail_url?'<img src="'+resp.thumbnail_url+'" class="thumb embedly-thumbnail-small" />':"";description=resp.description;code=thumb+"<a class='embedly-title' href='"+url+"'>"+title+"</a>";code+=description}pr='<div class="embedly">'+code+"</div>";preview.innerHTML=pr}}else{preview.innerHTML="<p class='error'>We couldn't process this URL. Try again, or email support@embed.ly.</p>"}request=null}};request.send()}function getInputValue(e,t){return document.forms[t].elements[e].value}function buildHref(){var e="",t=[],n,r,i,s;var o=tinyMCEPopup.editor;e=document.getElementById("externalurl").value;for(i in value_getter){s=document.getElementById(value_getter[i]).value;if(s!=="")t[value_getter[i]]=s}for(i in checked_getter){s=document.getElementById(checked_getter[i]).checked;if(s)t[checked_getter[i]]="true"}for(i in unchecked_getter){s=document.getElementById(unchecked_getter[i]).checked;if(s)t[unchecked_getter[i]]="false"}for(i in t){if(e.indexOf("?")===-1){e+="?"}else{e+="&"}e+=i+"="+t[i]}document.forms[0].href.value=e}function insertAction(){var e=tinyMCEPopup.editor;var t,n,r;buildHref();t=e.selection.getNode();t=e.dom.getParent(t,"A");if(!document.forms[0].href.value){tinyMCEPopup.execCommand("mceBeginUndoLevel");r=e.selection.getBookmark();e.dom.remove(t,1);e.selection.moveToBookmark(r);tinyMCEPopup.execCommand("mceEndUndoLevel");tinyMCEPopup.close();return}tinyMCEPopup.execCommand("mceBeginUndoLevel");if(t===null){e.getDoc().execCommand("unlink",false,null);tinyMCEPopup.execCommand("CreateLink",false,"#mce_temp_url#",{skip_undo:1});n=tinymce.grep(e.dom.select("a"),function(t){return e.dom.getAttrib(t,"href")=="#mce_temp_url#"});for(r=0;r<n.length;r++)setAllAttribs(t=n[r])}else setAllAttribs(t);if(t&&(t.childNodes.length!=1||t.firstChild.nodeName!="IMG")){e.focus();e.selection.select(t);e.selection.collapse(0);tinyMCEPopup.storeSelection()}tinyMCEPopup.execCommand("mceEndUndoLevel");tinyMCEPopup.close()}function setAllAttribs(e){var t=document.forms[0];var n=document.forms[1];var r=document.forms[2];var i=t.href.value;setAttrib(e,"href",i,0);setAttrib(e,"title",n.title.value,2);var s=tinyMCEPopup.editor.dom;s.addClass(e,"embedlylink");if(tinyMCE.isMSIE5)e.outerHTML=e.outerHTML}function getSelectValue(e,t){var n=e.elements[t];if(!n||n.options===null||n.selectedIndex==-1)return"";return n.options[n.selectedIndex].value}var templates={"window.open":"window.open('${url}','${target}','${options}')"};var current_path;var current_link="";var current_url="";var current_pageanchor="";var labels="";var value_getter=["maxwidth","maxheight","width","callback","wmode","words","chars"];var checked_getter=["allowscripts","nostyle","autoplay","videosrc"];var unchecked_getter=["youtube_rel"];preinit();tinyMCEPopup.onInit.add(init)